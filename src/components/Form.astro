---
if (Astro.request.method === "POST") {
  try {
    const data = await Astro.request.formData();
    const name = data.get("username");
    const email = data.get("email");
    const message = data.get("message");
    const response = await fetch(
      "https://script.google.com/macros/s/AKfycbz7Flmk_dlQFwKPpLQUQ1rJquJ04D1hpRJ-k5HOMRWUr0SOyf1ziW4aJh9U9sM8DSdR/exec",
      {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
        },
        body: JSON.stringify({ name, email, message }),
      }
    );
    if (response.ok) {
      alert("Message sent!");
    } else {
      alert("Message failed to send.");
    }
  } catch (error) {
    if (error instanceof Error) {
      console.error(error.message);
    }
  }
}

// window.addEventListener("load", function () {
//   const form = document.getElementById("my-form");
//   form.addEventListener("submit", function (e) {
//     e.preventDefault();
//     const data = Astro.request.formData();
//     const action = Astro.request.action;
//     fetch(action, {
//       method: "POST",
//       body: data,
//     }).then(() => {
//       alert("Success!");
//     });
//   });
// });
---

<section
  class="flex justify-center flex-col py-32 bg-background text-light"
  id="contact"
>
  <h2 class="text-center text-h2 my-4">CONTACT US</h2>
  <p class="text-3xl text-center my-8">
    For booking details, please reach out using the form below!
  </p>
  <form class="flex flex-col items-center" method="post">
    <label for="name" class="text-2xl my-4">Name</label>
    <input
      type="text"
      id="name"
      name="name"
      class="w-96 p-2 text-dark"
      required
    />
    <label for="email" class="text-2xl my-4">Email</label>
    <input
      type="email"
      id="email"
      name="email"
      class="w-96 p-2 text-dark"
      required
    />
    <label
      for="message"
      class="block mb-2 my-4 text-2xl font-medium text-gray-900 dark:text-white"
      >Message</label
    >
    <textarea
      id="message"
      name="message"
      rows="4"
      class="block p-2.5 w-96 text-md text-gray-900 bg-gray-50 rounded-lg border border-gray-300 focus:ring-blue-500 focus:border-blue-500"
      placeholder="Leave a message..."></textarea>
    <button
      type="submit"
      class="bg-blue-500 text-light text-2xl p-2 my-8 hover:bg-blue-700 rounded-lg w-96"
      >Submit</button
    >
  </form>
</section>
